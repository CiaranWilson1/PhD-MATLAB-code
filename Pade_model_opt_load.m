% G21 = -0.586689002649106 + 0.119498151170060i;             %10dBm
% G21_21_10 = -0.310318329683989 - 0.404044252136689i;
% G21_21_01 = -0.051209881392139 - 0.035785308852746i;
% G21_21_11 = 0.116394739208534 + 0.003904178297551i;
% H21_21_10 = 0.050766971107569 + 0.082011620629435i;
% H21_21_01 = -0.034815284077558 + 0.138632281848587i;
% H21_21_11 = -0.135136110277208 - 0.239960051364811i;

% G21 = -0.586689002649106 + 0.119498151170060i;             %10dBm Imod
% G21_21_10 = -0.3138 - 0.3989i;
% G21_21_01 = -0.0514 - 0.0349i;
% G21_21_11 = 0.1144 - 0.0010i;
% H21_21_10 = 0.0410 + 0.0918i;
% H21_21_01 = -0.0104 + 0.1412i;
% H21_21_11 = -0.1594 - 0.3048i;

G21 = -0.7844 + 0.1040i;             %10dBm diffLSOP
G21_21_10 = -0.2535 - 0.3824i;
G21_21_01 = -0.0470 - 0.0703i;
G21_21_11 = -0.1395 - 0.3719i;
H21_21_10 = 0.1093 - 0.1241i;
H21_21_01 = 0.5714 + 0.1157i;
H21_21_11 = -0.5185 - 0.2999i;

% G21 = -0.7844 + 0.1040i;             %10dBm diffLSOP wider points
% G21_21_10 = -0.2617 - 0.3928i;
% G21_21_01 = -0.0522 - 0.0606i;
% G21_21_11 = -0.0181 - 0.1531i;
% H21_21_10 = 0.0933 - 0.0882i;
% H21_21_01 = 0.1132 + 0.0235i;
% H21_21_11 = -0.0660 - 0.1101i;

% G21 = -7.0544 - 0.8278i;             %30dBm diffLSOP
% G21_21_10 = -0.3323 - 0.2119i;
% G21_21_01 = 0.0288 - 0.1091i;
% G21_21_11 = 0.0351 + 0.0041i;
% H21_21_10 = -0.0370 - 0.0153i;
% H21_21_01 = 0.0112 - 0.0130i;
% H21_21_11 = -0.0165 - 0.0015i;


% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBm
% G21_21_10 = -0.336466615348658 - 0.307837440973958i;
% G21_21_01 = -0.071035340445909 - 0.047618080308848i;
% G21_21_11 = 0.039670718297769 - 0.000746095039847i;
% H21_21_10 = -0.029361525863586 + 0.032689525877057i;
% H21_21_01 = 0.003174144615167 + 0.067265725006984i;
% H21_21_11 = -0.009274169307263 - 0.038377715700306i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBm modI
% G21_21_10 = -0.3355 - 0.2991i;
% G21_21_01 = -0.0705 - 0.0454i;
% G21_21_11 = 0.0392 - 0.0029i;
% H21_21_10 = -0.0283 + 0.0376i;
% H21_21_01 = 0.0116 + 0.0689i;
% H21_21_11 = -0.0170 - 0.0441i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmPosFix
% G21_21_10 = -0.3365 - 0.3078i;
% G21_21_01 = -0.0710 - 0.0476i;
% G21_21_11 = 0.0397 - 0.0007i;
% H21_21_10 = -0.0300 + 0.0328i;
% H21_21_01 = 0.0038 + 0.0670i;
% H21_21_11 = -0.0093 - 0.0384i;

a21_lsop = 0.2292 - 0.3210i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmAsqNum
% G21_21_10 = -0.3209 - 0.3005i;
% G21_21_01 = -0.0689 - 0.0447i;
% G21_21_11 = -0.1152 - 0.0081i;
% H21_21_10 = 0.1632 - 0.1306i;
% H21_21_01 = 0.0320 + 0.0332i;
% H21_21_11 = -0.0181 - 0.0379i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmConjAsqNum
% G21_21_10 = -0.3384 - 0.3036i;
% G21_21_01 = -0.0674 - 0.0472i;
% G21_21_11 = -0.0065 + 0.0009i;
% H21_21_10 = -0.0302 + 0.0328i;
% H21_21_01 = 0.0643 + 0.0041i;
% H21_21_11 = -0.0113 - 0.0403i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmAsqDen
% G21_21_10 = -0.3183 - 0.3399i;
% G21_21_01 = -0.0674 - 0.0550i;
% G21_21_11 = 0.0388 - 0.0007i;
% H21_21_10 = -0.0275 + 0.0231i;
% H21_21_01 = -0.0079 + 0.0586i;
% H21_21_11 = 0.0090 - 0.0059i;
% 
% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmconjAsqDen
% G21_21_10 = -0.3162 - 0.3376i;
% G21_21_01 = -0.0534 - 0.0495i;
% G21_21_11 = 0.0274 + 0.0059i;
% H21_21_10 = -0.0238 + 0.0150i;
% H21_21_01 = 0.0055 + 0.0328i;
% H21_21_11 = -0.0139 + 0.0051i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmA21A21
% G21_21_10 = -0.3129 - 0.3477i;
% G21_21_01 = -0.0639 - 0.0542i;
% G21_21_11 = -0.0736 + 0.0839i;
% H21_21_10 = -0.0470 - 0.2223i;
% H21_21_01 = 0.0522 + 0.0414i;
% H21_21_11 = 0.0122 - 0.0020i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmA21Conj
% G21_21_10 = -0.3092 - 0.3331i;
% G21_21_01 = -0.0463 - 0.0497i;
% G21_21_11 = -0.0825 - 0.0427i;
% H21_21_10 = 0.1688 - 0.0461i;
% H21_21_01 = 0.0257 + 0.0100i;
% H21_21_11 = -0.0180 + 0.0114i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmConjA21
% G21_21_10 = -0.3203 - 0.3383i;
% G21_21_01 = -0.0638 - 0.0551i;
% G21_21_11 = -0.0067 + 0.0007i;
% H21_21_10 = -0.0280 + 0.0225i;
% H21_21_01 = 0.0504 - 0.0029i;
% H21_21_11 = 0.0093 - 0.0067i;

% G21 = -2.046589165091140 + 0.328935533623069i;             %20dBmConjConj
% G21_21_10 = -0.3203 - 0.3383i;
% G21_21_01 = -0.0638 - 0.0551i;
% G21_21_11 = -0.0067 + 0.0007i;
% H21_21_10 = -0.0280 + 0.0225i;
% H21_21_01 = 0.0504 - 0.0029i;
% H21_21_11 = 0.0093 - 0.0067i;

% G21 = -3.378745715518210 + 0.434889772926056i;             %25dBm
% G21_21_10 = -0.382888986220890 - 0.247327121433667i;
% G21_21_01 = -0.102537210294192 - 0.041606871580604i;
% G21_21_11 = 0.045727333239506 + 0.000579988122513i;
% H21_21_10 = -0.032958627967262 - 0.001300960013410i;
% H21_21_01 = 0.002819765818611 + 0.024414748630290i;
% H21_21_11 = -0.005413026807677 - 0.007723160951856i;

% G21 = -3.378745715518210 + 0.434889772926056i;             %25dBm modI
% G21_21_10 = -0.3918 - 0.2273i;
% G21_21_01 = -0.1031 - 0.0346i;
% G21_21_11 = 0.0463 - 0.0042i;
% H21_21_10 = -0.0355 + 0.0090i;
% H21_21_01 = 0.0103 + 0.0362i;
% H21_21_11 = -0.0073 - 0.0173i;

% G21 = -4.450241047673360 + 0.431544745343981i;             %30dBm
% G21_21_10 = -0.508638749169914 - 0.117392435356162i;
% G21_21_01 = -0.177337408141471 - 0.084507328718156i;
% G21_21_11 = 0.043195835583746 + 0.011302013641606i;
% H21_21_10 = -0.023120323151133 - 0.010918216932593i;
% H21_21_01 = -0.019013113729430 - 0.004078785342594i;
% H21_21_11 = 0.001343615736020 - 0.002166959560061i;

% G21 = -4.450241047673360 + 0.431544745343981i;             %30dBm ModI
% G21_21_10 = -0.5064 - 0.1106i;
% G21_21_01 = -0.1778 - 0.0818i;
% G21_21_11 = 0.0432 + 0.0108i;
% H21_21_10 = -0.0225 - 0.0084i;
% H21_21_01 = -0.0180 - 0.0023i;
% H21_21_11 = 0.0005 - 0.0036i;


% XI = 0.151;
% XY = 0.072 + 0.043i;
%XI = 0.083545446575342;
XI = 0.0843551;
%XY = 0.072 + 0.043i;
%XY = 0.056761876198467 - 0.079639956248397i;
XY = 0.0478 - 0.0652i;

%Id = XI + XY*a21;

% G21_21_10 = 0.399073107887751 - 0.079026750514570i;
% G21_21_01 = -0.047461945877245 - 0.019440247393239i;
% G21_21_11 = 0.403718199094166 - 0.335199870437252i;
% H21_21_01 = 0.361595268628598 + 0.215593296672353i;

% G21_21_10 = 0.343967510218790 - 0.086894898874632i;
% G21_21_01 = -0.065980720723879 + 0.036941547945408i;
% H21_21_10 = -0.294632349551812 - 0.352565091209919i;
% H21_21_01 = -0.781997293236714 + 0.648604367123539i;

% G21_21_10 = 0.376199720206109 - 0.068044506378446i;
% G21_21_01 = -0.033853995238877 - 0.028600709628363i;
% G21_21_11 = 0.479097213617885 - 0.213236475522457i;
% H21_21_10 = -0.370056123041227 - 0.278924895939160i;
% H21_21_01 = 0.426180448283295 + 0.439083770754304i;

% G21_21_10 = 0.218654331306956 - 0.036868935761015i;
% G21_21_01 = -0.044139007453672 + 0.022189736975621i;
% H21_21_10 = -0.235097088163159 - 0.273174764682638i;
% H21_21_01 = -0.572534402727573 + 0.433250145209768i;
% H21_21_11 = -2.878391210942978 + 0.336375437712242i;

syms a21 a21conj a21R a21I
assume(a21,'real')
assume(a21conj,'real')

Id = XI + real(XY*a21);
%Pdc = 2*15*Id;
Pdc = 2*28*Id;

b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj + H21_21_11*a21*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*(a21-a21_lsop) + G21_21_01*(a21conj-conj(a21_lsop)) + G21_21_11*(a21conj-conj(a21_lsop)).^2)./(1 + H21_21_10*(a21-a21_lsop) + H21_21_01*(a21conj-conj(a21_lsop)) + H21_21_11*(a21conj-conj(a21_lsop)).^2);

%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_num_reg*a21*a21 + G21_num_conj*a21conj*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj + H21_den_reg*a21*a21 + H21_den_conj*a21conj*a21conj + H21_21_11*a21*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_num_reg*a21*a21 + G21_num_conj*a21conj*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj + H21_21_11*a21*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj + H21_21_11*a21*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_01*a21conj);
%b21s(a21,a21conj) = G21 + (G21_21_10*a21 + G21_21_01*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj);
Pouts(a21,a21conj) = b21s(a21,a21conj)*conj(b21s(a21conj,a21)) - a21*a21conj;

Pouts_Pdc(a21,a21conj) = (b21s(a21,a21conj)*conj(b21s(a21conj,a21)) - a21*a21conj)./(2*28*(XI+real(XY*a21)));
%Pouts_Pdc(a21,a21conj) = (b21s(a21,a21conj)*conj(b21s(a21conj,a21)) - a21*a21conj)./(2*28*ID);
Pouts_Pdc1(a21,a21conj) = (b21s(a21,a21conj)*conj(b21s(a21conj,a21)) - a21*a21conj)./(2*28*(XI+real(XY*a21conj)));

eqn1(a21,a21conj) = diff(Pouts,a21) == 0;
eqn2(a21,a21conj) = diff(Pouts,a21conj) == 0;

eqn3 = eqn1(a21R+1j*a21I, a21R-1j*a21I);
eqn4 = eqn2(a21R+1j*a21I, a21R-1j*a21I);

digits(8)
tic;
soln = vpasolve(eqn3, eqn4);
toc;
a21s = soln.a21R + 1j*soln.a21I;
b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s)+G21_21_11*a21s.*conj(a21s))./(1+H21_21_10*a21s+H21_21_01*conj(a21s)+H21_21_11*conj(a21s).*a21s);
%b21opt1_P = G21+(G21_21_10*(a21s-a21_lsop)+G21_21_01*conj(a21s-a21_lsop)+G21_21_11*(a21s-a21_lsop).*conj(a21s-a21_lsop))./(1+H21_21_10*(a21s-a21_lsop)+H21_21_01*conj(a21s-a21_lsop)+H21_21_11*conj(a21s-a21_lsop).*(a21s-a21_lsop));
%b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s)+G21_21_11*conj(a21s).^2)./(1+H21_21_10*a21s+H21_21_01*conj(a21s)+H21_21_11*conj(a21s).^2);

%b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s)+G21_num_reg*a21s.*a21s+G21_num_conj*conj(a21s).*conj(a21s)+G21_21_11*a21s.*conj(a21s))./(1+H21_21_10*a21s+H21_21_01*conj(a21s)+H21_den_reg*a21s.*a21s+H21_den_conj*conj(a21s).*conj(a21s)+H21_21_11*conj(a21s).*a21s);
%b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s)+G21_num_reg*a21s.*a21s+G21_num_conj*conj(a21s).*conj(a21s)+G21_21_11*a21s.*conj(a21s))./(1+H21_21_10*a21s+H21_21_01*conj(a21s)+H21_21_11*conj(a21s).*a21s);
%b21opt1_P = G21 + (G21_21_10*a21s + G21_21_01*conj(a21s) + G21_21_11*a21s.*conj(a21s))./(1 + H21_21_10*a21s + H21_21_01*conj(a21s));
%b21opt1_P = G21 + (G21_21_10*a21s + G21_21_01*conj(a21s))./(1 + H21_21_10*a21s + H21_21_01*conj(a21s) + H21_21_11*conj(a21s).*a21s);
% b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s)+G21_21_11*a21s.*conj(a21s))./(1+H21_21_01*conj(a21s));
%b21opt1_P = G21+(G21_21_10*a21s+G21_21_01*conj(a21s))./(1+H21_21_10*a21s+H21_21_01*conj(a21s));

gammaOpt_P = a21s./b21opt1_P;
gammaOptP = double(gammaOpt_P);

eqn5(a21,a21conj) = diff(Pouts_Pdc,a21) == 0;
eqn6(a21,a21conj) = diff(Pouts_Pdc1,a21conj) == 0;

eqn7 = eqn5(a21R+1j*a21I, a21R-1j*a21I);
eqn8 = eqn6(a21R+1j*a21I, a21R-1j*a21I);

tic;
soln1 = vpasolve(eqn7, eqn8);
toc;

a21s_eff = soln1.a21R + 1j*soln1.a21I;
b21opt1_P_eff = G21+(G21_21_10*a21s_eff+G21_21_01*conj(a21s_eff)+G21_21_11*a21s_eff.*conj(a21s_eff))./(1+H21_21_10*a21s_eff+H21_21_01*conj(a21s_eff)+H21_21_11*conj(a21s_eff).*a21s_eff);
%b21opt1_P_eff = G21 + (G21_21_10*a21s_eff + G21_21_01*conj(a21s_eff) + G21_21_11*a21s_eff.*conj(a21s_eff))./(1 + H21_21_10*a21s_eff + H21_21_01*conj(a21s_eff));
%b21opt1_P_eff = G21 + (G21_21_10*a21s_eff + G21_21_01*conj(a21s_eff))./(1 + H21_21_10*a21s_eff + H21_21_01*conj(a21s_eff) + H21_21_11*conj(a21s_eff).*a21s_eff);
%b21opt1_P_eff = G21+(G21_21_10*a21s_eff+G21_21_01*conj(a21s_eff))./(1+H21_21_10*a21s_eff+H21_21_01*conj(a21s_eff));
gammaOpt_P_eff = a21s_eff./b21opt1_P_eff;

sm2=smithchart;
hold all;plot(real(gammaOptP),imag(gammaOptP),'ro','LineWidth',1.5);
hold off;

filename = 'C:\Users\Ciaran Wilson\Documents\UMS_PDK_v1_wrk\Pdel.txt';
%filename = 'C:\Users\Ciaran Wilson\Documents\UMS_PDK_v1_wrk\PAE.txt';

fp1 = fopen(filename);
C = textscan(fp1,'%f %f %f','Delimiter',{',','<invalid>'},...
'TreatAsEmpty',{'NA','na'},'CommentStyle','X1');

filename1 = 'C:\Users\Ciaran Wilson\Documents\UMS_PDK_v1_wrk\a21_test.txt';
fp2 = fopen(filename1);
C1 = textscan(fp2,'%f %f %f / %f','Delimiter',{',','<invalid>'},...
'TreatAsEmpty',{'NA','na'},'CommentStyle','X1');

filename = 'C:\Users\Ciaran Wilson\Documents\UMS_PDK_v1_wrk\a21.txt';

fp1 = fopen(filename);

C2 = textscan(fp1,'%f %f %f / %f','Delimiter',{',','<invalid>'},...
'TreatAsEmpty',{'NA','na'},'CommentStyle','phasez');


jj=1;
phase = C2{1}(:);
mag = C2{2}(:);
mag1 = C2{3}(:);
mag1=mag1(~isnan(mag1));
phase1 = C2{4}(:);

phase1 = [phase1];
mag1 = [mag1];
a21_ext=mag1.*exp(1j*(pi/180).*phase1);

size=20;

imag_gamma = C{1}(:);
real_gamma = C{2}(:);
Pdel = C{3}(:);
a21_mag = C1{3}(:);
a21_phase = C1{4}(:);
a21_meas=a21_mag.*exp(1j*(pi/180).*a21_phase);
%b21opt1_Pade = G21+(G21_21_10*a21_meas+G21_21_01*conj(a21_meas)+G21_21_11*a21_meas.*conj(a21_meas))./(1+H21_21_10*a21_meas+H21_21_01*conj(a21_meas)+H21_21_11*conj(a21_meas).*a21_meas);
b21opt1_Pade = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj);
%b21opt1_Pade = G21+(G21_21_10*a21_meas+G21_21_01*conj(a21_meas)+G21_21_11*a21_meas.*conj(a21_meas))./(1+H21_21_01*conj(a21_meas));
%b21opt1_Pade = G21+(G21_21_10*a21_meas+G21_21_01*conj(a21_meas))./(1+H21_21_10*a21_meas+H21_21_01*conj(a21_meas));
Pout_W_Pade = abs(b21opt1_Pade).^2 - abs(a21_meas).^2;
Pout_dBm_Pade = 10*log10(Pout_W_Pade) + 30;

imag_gamma1 = reshape(imag_gamma,size,size)';
real_gamma1 = reshape(real_gamma,size,size)';
imag_a211 = reshape(imag(a21_meas),size,size)';
real_a211 = reshape(real(a21_meas),size,size)';
Pdel1 = reshape(Pdel,size,size)';
Pdel_Pade=reshape(Pout_dBm_Pade,size,size)';
figure
mesh(imag_gamma1,real_gamma1, Pdel1)
hold on;
mesh(imag_gamma1,real_gamma1, Pdel_Pade,'LineStyle', 'none','MarkerFaceColor', 'black', 'Marker', 'o')
figure
mesh(imag_a211,real_a211, Pdel_Pade)
figure
contourf(imag_a211,real_a211, Pdel_Pade)
hold on;
plot(imag(a21s),real(a21s),'ro','Linewidth',1.5)

min_imag=min(min(imag_a211));
max_imag=max(max(imag_a211));
min_real=min(min(real_a211));
max_real=max(max(real_a211));
a21s_mod=find(imag(a21s) > min_imag & imag(a21s) < max_imag & real(a21s) > min_real & real(a21s) < max_real);
new_a21s = a21s(a21s_mod);
%b21opt1_Pade_new = G21+(G21_21_10*new_a21s+G21_21_01*conj(new_a21s)+G21_21_11*new_a21s.*conj(new_a21s))./(1+H21_21_10*new_a21s+H21_21_01*conj(new_a21s)+H21_21_11*conj(new_a21s).*new_a21s);
b21opt1_Pade_new = G21 + (G21_21_10*a21 + G21_21_01*a21conj + G21_21_11*a21*a21conj)./(1 + H21_21_10*a21 + H21_21_01*a21conj);
%b21opt1_Pade_new = G21+(G21_21_10*new_a21s+G21_21_01*conj(new_a21s)+G21_21_11*new_a21s.*conj(new_a21s))./(1+H21_21_01*conj(new_a21s));
%b21opt1_Pade_new = G21+(G21_21_10*new_a21s+G21_21_01*conj(new_a21s))./(1+H21_21_10*new_a21s+H21_21_01*conj(new_a21s));
Pout_W_Pade_new = abs(b21opt1_Pade_new).^2 - abs(new_a21s).^2;
Pout_dBm_Pade_new = 10*log10(Pout_W_Pade_new) + 30;

gamma_opt_new = new_a21s./b21opt1_Pade_new;
figure
sm3=smithchart;
hold all;plot(real(gamma_opt_new),imag(gamma_opt_new),'ro','LineWidth',1.5);
hold off;
% figure
% sm4 = smithchart;
% hold on;plot(real(gammaOpt_P_eff),imag(gammaOpt_P_eff),'ro','Linewidth',1.5)
% hold off; 
% a21s_mod_eff=find(imag(a21s_eff) > min_imag & imag(a21s_eff) < max_imag & real(a21s_eff) > min_real & real(a21s_eff) < max_real);
% new_a21s_eff = a21s_eff(a21s_mod_eff);
% new_b21s_eff = b21opt1_P_eff(a21s_mod_eff);
% gammaOpt_P_new_eff = new_a21s_eff./new_b21s_eff;
% 
% figure
% sm5 = smithchart;
% hold on;plot(real(gammaOpt_P_new_eff),imag(gammaOpt_P_new_eff),'ro','Linewidth',1.5)
% hold off;
% 
% filename = 'C:\Users\Ciaran Wilson\Documents\UMS_PDK_v1_wrk\drain_eff.txt';
% 
% fp1 = fopen(filename);
% 
% C3 = textscan(fp1,'%f %f %f','Delimiter',{',','<invalid>'},...
% 'TreatAsEmpty',{'NA','na'},'CommentStyle','X1');
% 
% drain_eff = C3{3}(:);
% drain_eff_mat = reshape(real(drain_eff),size,size)';
% 
% figure
% contourf(imag_a211,real_a211, drain_eff_mat)
% hold on; plot(imag(new_a21s_eff),real(new_a21s_eff),'ro','Linewidth',1.5)
% hold off;

